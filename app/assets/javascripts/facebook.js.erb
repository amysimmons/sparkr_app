(function() {
  jQuery(function() {
    $('body').prepend('<div id="fb-root"></div>');
    return $.ajax({
      url: window.location.protocol + "//connect.facebook.net/en_US/all.js",
      dataType: 'script',
      cache: true
    });
  });

  window.fbAsyncInit = function() {
    FB.init({
      appId: '<%= ENV["facebook_app_id"] %>',
      cookie: true
    });

    $('#sign_in').click(function(e) {
      e.preventDefault();
      return FB.login(function(response) {
        if (response.authResponse) {
          // DO NOT ADD CURLY BRACKETS TO SIGNED_REQUEST - THIS REMORES THE ':' ERROR BUT BREAKS THE SIGN IN
          return window.location = '/auth/facebook/callback?' + $.param(signed_request: response.authResponse.signedRequest);
        }
      });
    });
    return $('#sign_out').click(function(e) {
      FB.getLoginStatus(function(response) {
        if (response.authResponse) {
          return FB.logout();
        }
      });
      return true;
    });
  };

}).call(this);






